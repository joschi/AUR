# Maintainer: Alexander Baldeck <kth5@archlinuxppc.org>
# Contributor: Jochen Schalanda <jochen+aur@schalanda.name>
pkgname=mcollective
pkgver=2.2.1
pkgrel=1
pkgdesc="Framework to build server orchestration or parallel job execution systems"
arch=(any)
url="http://www.puppetlabs.com/mcollective/"
license=('APACHE')
depends=('ruby>=1.9' 'ruby-stomp' 'ruby-systemu')
source=(http://puppetlabs.com/downloads/mcollective/${pkgname}-${pkgver}.tgz
        mcollective.init)
md5sums=('f36b754a4f874525d1f4be31e1e4da4a'
         'eded4e2a755bb05cbe0a2a52ec84b4c9')

build() {
  cd "${srcdir}/${pkgname}-$pkgver"
  install -d -m0755 ${pkgdir}/usr/lib/ruby/site_ruby/mcollective
  install -d -m0755 ${pkgdir}/usr/bin
  install -d -m0755 ${pkgdir}/usr/sbin
  install -d -m0755 ${pkgdir}/etc/init.d
  install -d -m0755 ${pkgdir}/usr/libexec/mcollective/
  install -d -m0755 ${pkgdir}/etc/mcollective
  install -d -m0755 ${pkgdir}/etc/mcollective/plugin.d
  install -d -m0755 ${pkgdir}/etc/mcollective/ssl
  install -d -m0755 ${pkgdir}/etc/mcollective/ssl/clients
  install -m0755 bin/mcollectived ${pkgdir}/usr/sbin/mcollectived
  install -m0755 bin/mc-call-agent ${pkgdir}/usr/sbin/mc-call-agent
  install -m0755 bin/mco ${pkgdir}/usr/sbin/mco
  install -m0640 etc/server.cfg.dist ${pkgdir}/etc/mcollective/server.cfg
  install -m0644 etc/client.cfg.dist ${pkgdir}/etc/mcollective/client.cfg
  install -m0444 etc/facts.yaml.dist ${pkgdir}/etc/mcollective/facts.yaml
  install -m0444 etc/rpc-help.erb ${pkgdir}/etc/mcollective/rpc-help.erb
  
  install -D -m0755 ${srcdir}/mcollective.init ${pkgdir}/etc/rc.d/mcollective

  cp -R lib/* ${pkgdir}/usr/lib/ruby/site_ruby/
  cp -R plugins/* ${pkgdir}/usr/libexec/mcollective/
}

# vim:set ts=2 sw=2 et:
